machine:
  node:
    version: 0.12.0
    
test:
    override:
        - MOCHA_FILE=${CIRCLE_TEST_REPORTS}/mocha/testResults.xml node ./node_modules/.bin/mocha --reporter mocha-junit-reporter
        
deployment:
  hub:
    branch: master
    commands:
      - git config user.email "robot@circleci.com"
      - git config user.name "CircleCI"
      - git config --global push.default matching
      - git checkout $BRANCH
      - echo "//registry.npmjs.org/:_authToken=${NPM_AUTH_TOKEN}" >> ~/.npmrc
      - npm version patch --message "auto-publish %s via CircleCI [ci skip] [skip ci]"
      - git remote set-url origin ssh://git@github.com/${CIRCLE_PROJECT_REPONAME}
      - git push
      - npm publish